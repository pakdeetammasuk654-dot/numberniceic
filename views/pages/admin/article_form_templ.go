// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.977
package admin

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

import (
	"fmt"
	"numberniceic/internal/core/domain"
)

func ArticleForm(isEdit bool, a *domain.Article) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<div style=\"margin-bottom: 2rem;\"><h1 style=\"font-family: 'Kanit', sans-serif;\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		if isEdit {
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "แก้ไขบทความ")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
		} else {
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "สร้างบทความใหม่")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "</h1><a href=\"/admin/articles\" class=\"link-button\">&larr; กลับไปหน้าจัดการบทความ</a></div><form id=\"article-form\" action=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var2 templ.SafeURL
		templ_7745c5c3_Var2, templ_7745c5c3_Err = templ.JoinURLErrs(templ.SafeURL(getFormAction(isEdit, a)))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `views/pages/admin/article_form.templ`, Line: 21, Col: 50}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var2))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 5, "\" method=\"post\" enctype=\"multipart/form-data\" style=\"background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);\"><div class=\"form-group\"><label for=\"title\">หัวข้อบทความ (Title)</label> <input type=\"text\" id=\"title\" name=\"title\" value=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var3 string
		templ_7745c5c3_Var3, templ_7745c5c3_Err = templ.JoinStringErrs(getArticleField(isEdit, a, "Title"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `views/pages/admin/article_form.templ`, Line: 28, Col: 89}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var3))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 6, "\" required></div><div class=\"form-group\"><label for=\"slug\">Slug (URL)</label> <input type=\"text\" id=\"slug\" name=\"slug\" value=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var4 string
		templ_7745c5c3_Var4, templ_7745c5c3_Err = templ.JoinStringErrs(getArticleField(isEdit, a, "Slug"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `views/pages/admin/article_form.templ`, Line: 32, Col: 86}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var4))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 7, "\" required> <small class=\"helper-text\">เช่น: my-article-title (ห้ามซ้ำ)</small></div><div class=\"form-group\"><label for=\"title_short\">ชื่อย่อ (Short Title)</label> <input type=\"text\" id=\"title_short\" name=\"title_short\" value=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var5 string
		templ_7745c5c3_Var5, templ_7745c5c3_Err = templ.JoinStringErrs(getArticleField(isEdit, a, "TitleShort"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `views/pages/admin/article_form.templ`, Line: 37, Col: 106}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var5))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 8, "\"></div><div class=\"form-group\"><label for=\"category\">หมวดหมู่ (Category)</label> <input type=\"text\" id=\"category\" name=\"category\" value=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var6 string
		templ_7745c5c3_Var6, templ_7745c5c3_Err = templ.JoinStringErrs(getArticleField(isEdit, a, "Category"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `views/pages/admin/article_form.templ`, Line: 41, Col: 98}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var6))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 9, "\" required></div><div class=\"form-group\"><label for=\"pin_order\">ลำดับการปักหมุด (Pin Order)</label> <input type=\"number\" id=\"pin_order\" name=\"pin_order\" min=\"0\" max=\"10\" value=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var7 string
		templ_7745c5c3_Var7, templ_7745c5c3_Err = templ.JoinStringErrs(getPinOrder(isEdit, a))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `views/pages/admin/article_form.templ`, Line: 45, Col: 103}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var7))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 10, "\"> <small class=\"helper-text\">ใส่เลข 1-10 เพื่อปักหมุดบทความ (0 = ไม่ปักหมุด)</small></div><div class=\"form-group\"><label for=\"image_file\">รูปภาพปก (Image)</label> ")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		if isEdit && a != nil {
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 11, "<div style=\"margin-bottom: 1rem;\"><img src=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var8 string
			templ_7745c5c3_Var8, templ_7745c5c3_Err = templ.JoinStringErrs(a.ImageURL)
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `views/pages/admin/article_form.templ`, Line: 52, Col: 26}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var8))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 12, "\" alt=\"Current Image\" style=\"max-width: 200px; border-radius: 8px; border: 1px solid #ddd;\"> <input type=\"hidden\" name=\"current_image_url\" value=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var9 string
			templ_7745c5c3_Var9, templ_7745c5c3_Err = templ.JoinStringErrs(a.ImageURL)
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `views/pages/admin/article_form.templ`, Line: 53, Col: 69}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var9))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 13, "\"></div>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 14, "<div style=\"display: flex; gap: 1rem; align-items: flex-start; flex-wrap: wrap;\"><div style=\"flex: 1; min-width: 300px;\"><input type=\"file\" id=\"image_file\" name=\"image_file\" accept=\"image/*\"> <small class=\"helper-text\">อัปโหลดไฟล์รูปภาพใหม่</small></div><div style=\"flex: 1; min-width: 300px;\"><div class=\"input-wrapper\"><input type=\"text\" id=\"image_url\" name=\"image_url\" placeholder=\"หรือระบุ URL รูปภาพ\" style=\"padding-right: 80px;\"> <button type=\"button\" onclick=\"openImagePickerForCover()\" style=\"position: absolute; right: 5px; top: 50%; transform: translateY(-50%); padding: 0.25rem 0.5rem; font-size: 0.8rem; background: #6c757d; border: none; color: white; border-radius: 4px; cursor: pointer;\">เลือกจากคลัง</button></div><small class=\"helper-text\">เลือกรูปภาพที่มีอยู่แล้วในระบบ</small></div></div></div><div class=\"form-group\"><label for=\"excerpt\">คำโปรย (Excerpt)</label> <textarea id=\"excerpt\" name=\"excerpt\" rows=\"3\" style=\"width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px; font-family: 'Sarabun', sans-serif;\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var10 string
		templ_7745c5c3_Var10, templ_7745c5c3_Err = templ.JoinStringErrs(getArticleField(isEdit, a, "Excerpt"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `views/pages/admin/article_form.templ`, Line: 72, Col: 207}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var10))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 15, "</textarea></div><div class=\"form-group\"><label for=\"content\">เนื้อหา (Content)</label> <textarea id=\"content\" name=\"content\" rows=\"20\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var11 string
		templ_7745c5c3_Var11, templ_7745c5c3_Err = templ.JoinStringErrs(getArticleField(isEdit, a, "Content"))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `views/pages/admin/article_form.templ`, Line: 76, Col: 90}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var11))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 16, "</textarea></div><div class=\"form-group\" style=\"display: flex; align-items: center; gap: 0.5rem;\"><input type=\"checkbox\" id=\"is_published\" name=\"is_published\" style=\"width: auto;\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		if isPublishedChecked(isEdit, a) {
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 17, " checked")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 18, "> <label for=\"is_published\" style=\"margin-bottom: 0;\">เผยแพร่ทันที (Publish)</label></div><div class=\"button-group\" style=\"margin-top: 2rem;\"><button type=\"submit\" style=\"background-color: #007bff;\">บันทึกข้อมูล</button> <a href=\"/admin/articles\" class=\"secondary-btn\" style=\"text-decoration: none; display: inline-block; text-align: center;\">ยกเลิก</a></div></form><!-- Image Picker Modal --><div id=\"image-picker-modal\" class=\"modal-overlay\" style=\"display: none; z-index: 9999;\"><div class=\"modal-content\" style=\"max-width: 90vw; width: 1200px;\"><div class=\"modal-header\"><h2>เลือกรูปภาพ</h2><button type=\"button\" class=\"close-btn\" onclick=\"closeImagePicker()\">&times;</button></div><div class=\"modal-body\" id=\"image-picker-grid\" style=\"display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 1rem; max-height: 70vh;\"><!-- Images will be loaded here --></div></div></div><!-- Dependencies --><script src=\"https://code.jquery.com/jquery-3.7.1.min.js\" integrity=\"sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=\" crossorigin=\"anonymous\"></script><link href=\"https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.css\" rel=\"stylesheet\"><script src=\"https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.js\"></script><script type=\"text/javascript\">\n        // Helper to wait for jQuery and Summernote\n        function waitForSummernote(callback) {\n            if (window.jQuery && window.jQuery.fn && window.jQuery.fn.summernote) {\n                callback();\n            } else {\n                setTimeout(function() { waitForSummernote(callback); }, 100);\n            }\n        }\n\n        // Main Init Function\n        const initSummernoteLogic = function() {\n            waitForSummernote(function() {\n                const contentEl = document.getElementById('content');\n                if (!contentEl) return;\n                \n                // Avoid double init\n                if (window.jQuery('#content').next().hasClass('note-editor')) {\n                    return;\n                }\n\n                // Custom button for Summernote\n                const LibraryButton = function (context) {\n                    const ui = $.summernote.ui;\n                    const button = ui.button({\n                        contents: '<i class=\"note-icon-picture\"/> Library',\n                        tooltip: 'เลือกรูปภาพจากคลัง',\n                        click: function () {\n                            if (typeof loadImagesAndShowModal === 'function') {\n                                loadImagesAndShowModal((url) => {\n                                    context.invoke('editor.insertImage', url);\n                                });\n                            }\n                        }\n                    });\n                    return button.render();\n                }\n\n                window.jQuery('#content').summernote({\n                    placeholder: 'เขียนเนื้อหาบทความที่นี่...',\n                    tabsize: 2,\n                    height: 500,\n                    toolbar: [\n                        ['style', ['style']],\n                        ['font', ['bold', 'underline', 'clear']],\n                        ['color', ['color']],\n                        ['para', ['ul', 'ol', 'paragraph']],\n                        ['table', ['table']],\n                        ['insert', ['link', 'library', 'video']],\n                        ['view', ['fullscreen', 'codeview', 'help']]\n                    ],\n                    buttons: {\n                        library: LibraryButton\n                    },\n                    styleTags: [\n                        'p',\n                        { title: 'Blockquote', tag: 'blockquote', className: 'blockquote', value: 'blockquote' },\n                        'pre', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'\n                    ],\n                    fontNames: ['Sarabun', 'Arial', 'Arial Black', 'Comic Sans MS', 'Courier New'],\n                    addDefaultFonts: false\n                });\n            });\n        };\n\n        // Helper functions\n        window.closeImagePicker = function() {\n            const el = document.getElementById('image-picker-modal');\n            if(el) el.style.display = 'none';\n        }\n\n        let imagePickerCallback = null;\n        window.loadImagesAndShowModal = function(callback) {\n            imagePickerCallback = callback;\n            const modal = document.getElementById('image-picker-modal');\n            const grid = document.getElementById('image-picker-grid');\n            if(!modal || !grid) return;\n\n            fetch('/admin/api/images')\n                .then(response => response.json())\n                .then(images => {\n                    grid.innerHTML = '';\n                    images.forEach(imageName => {\n                        const imgContainer = document.createElement('div');\n                        imgContainer.style.cursor = 'pointer';\n                        imgContainer.style.border = '1px solid #ddd';\n                        imgContainer.style.borderRadius = '4px';\n                        imgContainer.style.overflow = 'hidden';\n                        imgContainer.style.position = 'relative';\n\n                        const img = document.createElement('img');\n                        img.src = `/uploads/${imageName}`;\n                        img.style.width = '100%';\n                        img.style.height = '120px';\n                        img.style.objectFit = 'cover';\n\n                        imgContainer.appendChild(img);\n                        imgContainer.onclick = () => {\n                            if (imagePickerCallback) {\n                                imagePickerCallback(`/uploads/${imageName}`);\n                            }\n                            window.closeImagePicker();\n                        };\n                        grid.appendChild(imgContainer);\n                    });\n                    modal.style.display = 'flex';\n                })\n                .catch(err => console.error('Error loading images:', err));\n        }\n\n        window.openImagePickerForCover = function() {\n            window.loadImagesAndShowModal((url) => {\n                const el = document.getElementById('image_url');\n                if(el) el.value = url;\n            });\n        }\n\n        // Manage Event Listeners and Initialization\n        if (window.summernoteInitHandler) {\n            document.body.removeEventListener('htmx:afterSettle', window.summernoteInitHandler);\n        }\n        window.summernoteInitHandler = initSummernoteLogic;\n        \n        // Add robust listener\n        document.body.addEventListener('htmx:afterSettle', window.summernoteInitHandler);\n\n        // Initial Run\n        if (document.readyState === 'loading') {\n            document.addEventListener('DOMContentLoaded', window.summernoteInitHandler);\n        } else {\n            // Slight delay to ensure scripts parsed\n            setTimeout(window.summernoteInitHandler, 0);\n        }\n    </script>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

func getFormAction(isEdit bool, a *domain.Article) string {
	if isEdit && a != nil {
		return fmt.Sprintf("/admin/articles/edit/%d", a.ID)
	}
	return "/admin/articles/create"
}

func getArticleField(isEdit bool, a *domain.Article, field string) string {
	if !isEdit || a == nil {
		return ""
	}
	switch field {
	case "Title":
		return a.Title
	case "Slug":
		return a.Slug
	case "TitleShort":
		return a.TitleShort
	case "Category":
		return a.Category
	case "Excerpt":
		return a.Excerpt
	case "Content":
		return a.Content
	}
	return ""
}

func getPinOrder(isEdit bool, a *domain.Article) string {
	if !isEdit || a == nil {
		return "0"
	}
	return fmt.Sprintf("%d", a.PinOrder)
}

func isPublishedChecked(isEdit bool, a *domain.Article) bool {
	if !isEdit {
		return true
	}
	if a == nil {
		return true
	}
	return a.IsPublished
}

var _ = templruntime.GeneratedTemplate
